% Options for packages loaded elsewhere
\PassOptionsToPackage{unicode}{hyperref}
\PassOptionsToPackage{hyphens}{url}
\PassOptionsToPackage{dvipsnames,svgnames,x11names}{xcolor}
%
\documentclass[
  letterpaper,
  DIV=11,
  numbers=noendperiod]{scrartcl}

\usepackage{amsmath,amssymb}
\usepackage{lmodern}
\usepackage{iftex}
\ifPDFTeX
  \usepackage[T1]{fontenc}
  \usepackage[utf8]{inputenc}
  \usepackage{textcomp} % provide euro and other symbols
\else % if luatex or xetex
  \usepackage{unicode-math}
  \defaultfontfeatures{Scale=MatchLowercase}
  \defaultfontfeatures[\rmfamily]{Ligatures=TeX,Scale=1}
\fi
% Use upquote if available, for straight quotes in verbatim environments
\IfFileExists{upquote.sty}{\usepackage{upquote}}{}
\IfFileExists{microtype.sty}{% use microtype if available
  \usepackage[]{microtype}
  \UseMicrotypeSet[protrusion]{basicmath} % disable protrusion for tt fonts
}{}
\makeatletter
\@ifundefined{KOMAClassName}{% if non-KOMA class
  \IfFileExists{parskip.sty}{%
    \usepackage{parskip}
  }{% else
    \setlength{\parindent}{0pt}
    \setlength{\parskip}{6pt plus 2pt minus 1pt}}
}{% if KOMA class
  \KOMAoptions{parskip=half}}
\makeatother
\usepackage{xcolor}
\setlength{\emergencystretch}{3em} % prevent overfull lines
\setcounter{secnumdepth}{-\maxdimen} % remove section numbering
% Make \paragraph and \subparagraph free-standing
\ifx\paragraph\undefined\else
  \let\oldparagraph\paragraph
  \renewcommand{\paragraph}[1]{\oldparagraph{#1}\mbox{}}
\fi
\ifx\subparagraph\undefined\else
  \let\oldsubparagraph\subparagraph
  \renewcommand{\subparagraph}[1]{\oldsubparagraph{#1}\mbox{}}
\fi

\usepackage{color}
\usepackage{fancyvrb}
\newcommand{\VerbBar}{|}
\newcommand{\VERB}{\Verb[commandchars=\\\{\}]}
\DefineVerbatimEnvironment{Highlighting}{Verbatim}{commandchars=\\\{\}}
% Add ',fontsize=\small' for more characters per line
\usepackage{framed}
\definecolor{shadecolor}{RGB}{241,243,245}
\newenvironment{Shaded}{\begin{snugshade}}{\end{snugshade}}
\newcommand{\AlertTok}[1]{\textcolor[rgb]{0.68,0.00,0.00}{#1}}
\newcommand{\AnnotationTok}[1]{\textcolor[rgb]{0.37,0.37,0.37}{#1}}
\newcommand{\AttributeTok}[1]{\textcolor[rgb]{0.40,0.45,0.13}{#1}}
\newcommand{\BaseNTok}[1]{\textcolor[rgb]{0.68,0.00,0.00}{#1}}
\newcommand{\BuiltInTok}[1]{\textcolor[rgb]{0.00,0.23,0.31}{#1}}
\newcommand{\CharTok}[1]{\textcolor[rgb]{0.13,0.47,0.30}{#1}}
\newcommand{\CommentTok}[1]{\textcolor[rgb]{0.37,0.37,0.37}{#1}}
\newcommand{\CommentVarTok}[1]{\textcolor[rgb]{0.37,0.37,0.37}{\textit{#1}}}
\newcommand{\ConstantTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{#1}}
\newcommand{\ControlFlowTok}[1]{\textcolor[rgb]{0.00,0.23,0.31}{#1}}
\newcommand{\DataTypeTok}[1]{\textcolor[rgb]{0.68,0.00,0.00}{#1}}
\newcommand{\DecValTok}[1]{\textcolor[rgb]{0.68,0.00,0.00}{#1}}
\newcommand{\DocumentationTok}[1]{\textcolor[rgb]{0.37,0.37,0.37}{\textit{#1}}}
\newcommand{\ErrorTok}[1]{\textcolor[rgb]{0.68,0.00,0.00}{#1}}
\newcommand{\ExtensionTok}[1]{\textcolor[rgb]{0.00,0.23,0.31}{#1}}
\newcommand{\FloatTok}[1]{\textcolor[rgb]{0.68,0.00,0.00}{#1}}
\newcommand{\FunctionTok}[1]{\textcolor[rgb]{0.28,0.35,0.67}{#1}}
\newcommand{\ImportTok}[1]{\textcolor[rgb]{0.00,0.46,0.62}{#1}}
\newcommand{\InformationTok}[1]{\textcolor[rgb]{0.37,0.37,0.37}{#1}}
\newcommand{\KeywordTok}[1]{\textcolor[rgb]{0.00,0.23,0.31}{#1}}
\newcommand{\NormalTok}[1]{\textcolor[rgb]{0.00,0.23,0.31}{#1}}
\newcommand{\OperatorTok}[1]{\textcolor[rgb]{0.37,0.37,0.37}{#1}}
\newcommand{\OtherTok}[1]{\textcolor[rgb]{0.00,0.23,0.31}{#1}}
\newcommand{\PreprocessorTok}[1]{\textcolor[rgb]{0.68,0.00,0.00}{#1}}
\newcommand{\RegionMarkerTok}[1]{\textcolor[rgb]{0.00,0.23,0.31}{#1}}
\newcommand{\SpecialCharTok}[1]{\textcolor[rgb]{0.37,0.37,0.37}{#1}}
\newcommand{\SpecialStringTok}[1]{\textcolor[rgb]{0.13,0.47,0.30}{#1}}
\newcommand{\StringTok}[1]{\textcolor[rgb]{0.13,0.47,0.30}{#1}}
\newcommand{\VariableTok}[1]{\textcolor[rgb]{0.07,0.07,0.07}{#1}}
\newcommand{\VerbatimStringTok}[1]{\textcolor[rgb]{0.13,0.47,0.30}{#1}}
\newcommand{\WarningTok}[1]{\textcolor[rgb]{0.37,0.37,0.37}{\textit{#1}}}

\providecommand{\tightlist}{%
  \setlength{\itemsep}{0pt}\setlength{\parskip}{0pt}}\usepackage{longtable,booktabs,array}
\usepackage{calc} % for calculating minipage widths
% Correct order of tables after \paragraph or \subparagraph
\usepackage{etoolbox}
\makeatletter
\patchcmd\longtable{\par}{\if@noskipsec\mbox{}\fi\par}{}{}
\makeatother
% Allow footnotes in longtable head/foot
\IfFileExists{footnotehyper.sty}{\usepackage{footnotehyper}}{\usepackage{footnote}}
\makesavenoteenv{longtable}
\usepackage{graphicx}
\makeatletter
\def\maxwidth{\ifdim\Gin@nat@width>\linewidth\linewidth\else\Gin@nat@width\fi}
\def\maxheight{\ifdim\Gin@nat@height>\textheight\textheight\else\Gin@nat@height\fi}
\makeatother
% Scale images if necessary, so that they will not overflow the page
% margins by default, and it is still possible to overwrite the defaults
% using explicit options in \includegraphics[width, height, ...]{}
\setkeys{Gin}{width=\maxwidth,height=\maxheight,keepaspectratio}
% Set default figure placement to htbp
\makeatletter
\def\fps@figure{htbp}
\makeatother

\usepackage{amsmath, xparse}
\usepackage{fancyvrb, fvextra}
\usepackage{bm}
\usepackage{svg}
\usepackage{listings}
\usepackage{sectsty}
\usepackage{xifthen}
\subsubsectionfont{\centering}
\DefineVerbatimEnvironment{Highlighting}{Verbatim}{breaklines,commandchars=\\\{\}}
\lstset{basicstyle=\ttfamily\footnotesize,breaklines=true}
\newcommand\rowop[1]{\scriptstyle\smash{\xrightarrow[\vphantom{#1}]{\mkern-4mu#1\mkern-4mu}}}
\DeclareDocumentCommand\converttorows%
{>{\SplitList{,}}m}%
{\ProcessList{#1}{\converttorow}}
\NewDocumentCommand{\converttorow}{m}
{\ifthenelse{\isempty{#1}}{}{\rowop{#1}}\\}

\DeclareDocumentCommand \rowops{m}
{\;
\begin{matrix}
\converttorows {#1}
\end{matrix}
\; }
\KOMAoption{captions}{tableheading}
\makeatletter
\makeatother
\makeatletter
\makeatother
\makeatletter
\@ifpackageloaded{caption}{}{\usepackage{caption}}
\AtBeginDocument{%
\ifdefined\contentsname
  \renewcommand*\contentsname{Table of contents}
\else
  \newcommand\contentsname{Table of contents}
\fi
\ifdefined\listfigurename
  \renewcommand*\listfigurename{List of Figures}
\else
  \newcommand\listfigurename{List of Figures}
\fi
\ifdefined\listtablename
  \renewcommand*\listtablename{List of Tables}
\else
  \newcommand\listtablename{List of Tables}
\fi
\ifdefined\figurename
  \renewcommand*\figurename{Figure}
\else
  \newcommand\figurename{Figure}
\fi
\ifdefined\tablename
  \renewcommand*\tablename{Table}
\else
  \newcommand\tablename{Table}
\fi
}
\@ifpackageloaded{float}{}{\usepackage{float}}
\floatstyle{ruled}
\@ifundefined{c@chapter}{\newfloat{codelisting}{h}{lop}}{\newfloat{codelisting}{h}{lop}[chapter]}
\floatname{codelisting}{Listing}
\newcommand*\listoflistings{\listof{codelisting}{List of Listings}}
\makeatother
\makeatletter
\@ifpackageloaded{caption}{}{\usepackage{caption}}
\@ifpackageloaded{subcaption}{}{\usepackage{subcaption}}
\makeatother
\makeatletter
\@ifpackageloaded{tcolorbox}{}{\usepackage[many]{tcolorbox}}
\makeatother
\makeatletter
\@ifundefined{shadecolor}{\definecolor{shadecolor}{rgb}{.97, .97, .97}}
\makeatother
\makeatletter
\makeatother
\ifLuaTeX
  \usepackage{selnolig}  % disable illegal ligatures
\fi
\IfFileExists{bookmark.sty}{\usepackage{bookmark}}{\usepackage{hyperref}}
\IfFileExists{xurl.sty}{\usepackage{xurl}}{} % add URL line breaks if available
\urlstyle{same} % disable monospaced font for URLs
\hypersetup{
  colorlinks=true,
  linkcolor={blue},
  filecolor={Maroon},
  citecolor={Blue},
  urlcolor={Blue},
  pdfcreator={LaTeX via pandoc}}

\author{}
\date{}

\begin{document}
\input{./title.tex}
\newpage

\ifdefined\Shaded\renewenvironment{Shaded}{\begin{tcolorbox}[sharp corners, borderline west={3pt}{0pt}{shadecolor}, interior hidden, enhanced, breakable, boxrule=0pt, frame hidden]}{\end{tcolorbox}}\fi

\renewcommand*\contentsname{Table of contents}
{
\hypersetup{linkcolor=}
\setcounter{tocdepth}{4}
\tableofcontents
}
\newpage{}

\hypertarget{column-vector-and-row-vector-matrix-multiplication}{%
\section{Column-vector and row-vector matrix
multiplication}\label{column-vector-and-row-vector-matrix-multiplication}}

\hypertarget{problem-4.17.11}{%
\subsection{Problem 4.17.11}\label{problem-4.17.11}}

Compute the result of the following matrix multiplications:

\begin{flalign*}
&(\text{a}) 
\begin{bmatrix}
2 & 3 & 1 \\
1 & 3 & 4
\end{bmatrix}
\begin{bmatrix}
2 \\
2 \\
3
\end{bmatrix}&\\
&=\begin{bmatrix}
2 \cdot 2 + 3 \cdot 2 + 1 \cdot 3 \\
1 \cdot 2 + 3 \cdot 2 + 4 \cdot 3
\end{bmatrix}&\\
&=\begin{bmatrix}
4+6+3 \\
2+6+12
\end{bmatrix}&\\
&=\begin{bmatrix}
13 \\
20
\end{bmatrix}&\\
&(\text{b}) 
\begin{bmatrix}
2 & 4 & 1
\end{bmatrix}
\begin{bmatrix}
1 & 2 & 0 \\
5 & 1 & 1 \\
2 & 3 & 0
\end{bmatrix}&\\
&=\begin{bmatrix}
2 \cdot 1 + 4 \cdot 5 + 1 \cdot 2 & 2 \cdot 2 + 4 \cdot 1 + 1 \cdot 3 & 2 \cdot 0 + 4 \cdot 1 + 1 \cdot 0
\end{bmatrix}&\\
&=\begin{bmatrix}
2+20+2 & 4+4+3 & 0+4+0 \\
\end{bmatrix}&\\
&=\begin{bmatrix}
24 & 11 & 4
\end{bmatrix}&\\
&(\text{c})
\begin{bmatrix}
2 & 1
\end{bmatrix}
\begin{bmatrix}
3 & 1 & 5 & 2 \\
-2 & 6 & 1 & -1
\end{bmatrix}&\\
&=\begin{bmatrix}
2 \cdot 3 + 1 \cdot -2 & 2 \cdot 1 + 1 \cdot 6 & 2 \cdot 5 + 1 \cdot 1 + 2 \cdot 2 + 1 \cdot -1
\end{bmatrix}&\\
&=\begin{bmatrix}
6+(-2) & 2+6 & 10+1 & 4+(-1)
\end{bmatrix}&\\
&=\begin{bmatrix}
4 & 8 & 11 & 3
\end{bmatrix}&\\
\end{flalign*}

\newpage{}

\begin{flalign*}
&(\text{d})
\begin{bmatrix}
1 & 2 & 3 & 4 \\
1 & 1 & 3 & 1
\end{bmatrix}
\begin{bmatrix}
1 \\
2 \\
3 \\
4
\end{bmatrix}&\\
&=\begin{bmatrix}
1 \cdot 1 + 2 \cdot 2 + 3 \cdot 3 + 4 \cdot 4 \\
1 \cdot 1 + 1 \cdot 2 + 3 \cdot 3 + 1 \cdot 4
\end{bmatrix}&\\
&=\begin{bmatrix}
1 + 4 + 9 + 16 \\
1 + 2 + 9 + 4
\end{bmatrix}&\\
&=\begin{bmatrix}
30 \\
16
\end{bmatrix}&\\
&(\text{e})
\begin{bmatrix}
4 \\
1 \\
-3 
\end{bmatrix}^{\intercal}
\begin{bmatrix}
-1 & 1 & 1 \\
1 & 0 & 2 \\
0 & 1 & -1
\end{bmatrix}&\\
&= \begin{bmatrix}
4 & 1 & -3
\end{bmatrix}
\begin{bmatrix}
-1 & 1 & 1 \\
1 & 0 & 2 \\
0 & 1 & -1
\end{bmatrix}&\\
&= \begin{bmatrix}
4 \cdot -1 + 1 \cdot 1 + -3 \cdot 0 & 4 \cdot 1 + 1 \cdot 0 + -3 \cdot 1 & 4 \cdot 1 + 1 \cdot 2 + -3 \cdot -1
\end{bmatrix}&\\
&= \begin{bmatrix}
-4 + 1 + 0 & 4 + 0 + (-3) & 4 + 2 + 3
\end{bmatrix} &\\
&= \begin{bmatrix}
-3 & 1 & 9
\end{bmatrix}
\end{flalign*}

\newpage{}

\hypertarget{matrix-class}{%
\section{Matrix Class}\label{matrix-class}}

\hypertarget{problem-4.17.12}{%
\subsection{Problem 4.17.12}\label{problem-4.17.12}}

You will write a module \texttt{mat} implementing a matrix classs
\texttt{Mat}. The data structure used for instances of \texttt{Mat}
resembles that used for isntances of \texttt{Vec}. The only difference
is that the domain \texttt{D} will now store a pair (i.e., a 2-tuple) of
sets instead of a single set. The keys of the dictionary \texttt{f} are
pairs of elements of the Cartesian product of the two sets in
\texttt{D}. The operations defined for \texttt{Mat} include entry
setters and getters, an equality test, addition and subtraction and
negative, multiplication by a scalar, transpose, vector-matrix, and
matrix-vector multiplication, and matrix-matrix multiplication. Like
\texttt{Vec}, the class \texttt{Mat} is defined to enable use of
operators such as \texttt{+} and \texttt{*}. The syntax for using
instances of \texttt{Mat} is as follows, where \texttt{A} and \texttt{B}
are matrices, \texttt{v} is a vector, \texttt{alpha} is a scalar,
\texttt{r} is a row label, and \texttt{c} is a column label:

\begin{table}[hbt!]
\centering
\begin{tabular}{ll}
operation                                      & syntax                               \\
Matrix addition and subtraction                & \verb|A+B| and \verb|A-B|                      \\
Matrix negative                                & \verb|-A|                                 \\
Scalar-matrix multiplication                   & \verb|alpha*A|                            \\
Matrix equality test                           & \verb|A==B|                               \\
Matrix transpose                               & \verb|A.transpose()|                      \\
Getting and setting a matrix entry             & \verb|A[r,c]| and \verb|A[r, c] = alpha| \\
Matrix-vector and vector-matrix multiplication & \verb|v*A| and \verb|A*v|                        \\
Matrix-matrix multiplication                   & \verb|A*B|                               
\end{tabular}
\end{table}

You are required to write the procedures
\texttt{equal,\ getitem,\ setitem,\ mat\_add,\ mat\_scalar\_mul,\ transpose,\ vector\_matrix\_mul,\ matrix\_vector\_mal,}
and \texttt{matrix\_matrix\_mul}. You should start by getting
\texttt{equal} working since \texttt{==} is used in the doctests for
other procedures.

\textbf{Note:} You are encouraged to use operator
(e.g.~\texttt{M{[}r,\ c{]}}) in your procedures. (Of course, you can't,
for example, use the syntax \texttt{M{[}r,\ c{]}} in your
\texttt{getitem} procedure.)

Put the file \texttt{mat.py} in your working directory, and, for each
procedure, replace the \texttt{pass} statement with a working version.
Test your implementation using \texttt{doctest} as you did with
\texttt{vec.py} in Problem 2.14.10. Make sure your implementation works
with matrices whose row-label sets differ from their column-label sets.

\textbf{Note:} Use the sparse matrix-vector multiplication algorithm
described in Section 4.8 (the one based on the ``ordinary'' definition)
for matrix-vector multiplication. Use the analogous algorithm for
vector-matrix multiplication. Do not use \texttt{transpose} in your
multiplication algorithms. Do not use any external proceduers or modules
other than \texttt{vec}. In particular, do not use procedures from
\texttt{matutil}. If you do, your \texttt{Mat} implementation is likely
not to be efficient enough for use with large sparse matrices.

\newpage{}

\begin{Shaded}
\begin{Highlighting}[numbers=left,,]
\CommentTok{\# Copyright 2013 Philip N. Klein}
\ImportTok{from}\NormalTok{ vec }\ImportTok{import}\NormalTok{ Vec}

\CommentTok{\#Test your Mat class over R and also over GF(2).  The following tests use only R.}
\KeywordTok{def}\NormalTok{ equal(A, B):}
    \CommentTok{"""}
\CommentTok{    Returns true iff A is equal to B.}
\CommentTok{    \textgreater{}\textgreater{}\textgreater{} Mat((\{\textquotesingle{}a\textquotesingle{},\textquotesingle{}b\textquotesingle{}\}, \{0,1\}), \{(\textquotesingle{}a\textquotesingle{},1):0\}) == Mat((\{\textquotesingle{}a\textquotesingle{},\textquotesingle{}b\textquotesingle{}\}, \{0,1\}), \{(\textquotesingle{}b\textquotesingle{},1):0\})}
\CommentTok{    True}
\CommentTok{    \textgreater{}\textgreater{}\textgreater{} A = Mat((\{\textquotesingle{}a\textquotesingle{},\textquotesingle{}b\textquotesingle{}\}, \{0,1\}), \{(\textquotesingle{}a\textquotesingle{},1):2, (\textquotesingle{}b\textquotesingle{},0):1\})}
\CommentTok{    \textgreater{}\textgreater{}\textgreater{} B = Mat((\{\textquotesingle{}a\textquotesingle{},\textquotesingle{}b\textquotesingle{}\}, \{0,1\}), \{(\textquotesingle{}a\textquotesingle{},1):2, (\textquotesingle{}b\textquotesingle{},0):1, (\textquotesingle{}b\textquotesingle{},1):0\})}
\CommentTok{    \textgreater{}\textgreater{}\textgreater{} C = Mat((\{\textquotesingle{}a\textquotesingle{},\textquotesingle{}b\textquotesingle{}\}, \{0,1\}), \{(\textquotesingle{}a\textquotesingle{},1):2, (\textquotesingle{}b\textquotesingle{},0):1, (\textquotesingle{}b\textquotesingle{},1):5\})}
\CommentTok{    \textgreater{}\textgreater{}\textgreater{} A == B}
\CommentTok{    True}
\CommentTok{    \textgreater{}\textgreater{}\textgreater{} A == C}
\CommentTok{    False}
\CommentTok{    \textgreater{}\textgreater{}\textgreater{} A == Mat((\{\textquotesingle{}a\textquotesingle{},\textquotesingle{}b\textquotesingle{}\}, \{0,1\}), \{(\textquotesingle{}a\textquotesingle{},1):2, (\textquotesingle{}b\textquotesingle{},0):1\})}
\CommentTok{    True}
\CommentTok{    """}
    \ControlFlowTok{assert}\NormalTok{ A.D }\OperatorTok{==}\NormalTok{ B.D}
    \ControlFlowTok{for}\NormalTok{ row }\KeywordTok{in}\NormalTok{ A.D[}\DecValTok{0}\NormalTok{]:}
        \ControlFlowTok{for}\NormalTok{ col }\KeywordTok{in}\NormalTok{ A.D[}\DecValTok{1}\NormalTok{]:}
            \ControlFlowTok{if}\NormalTok{ getitem(A,(row, col)) }\OperatorTok{!=}\NormalTok{ getitem(B,(row, col)): }
                \ControlFlowTok{return} \VariableTok{False}
    \ControlFlowTok{return} \VariableTok{True}
 
\KeywordTok{def}\NormalTok{ getitem(M, k):}
    \CommentTok{"""}
\CommentTok{    Returns the value of entry k in M, where k is a 2{-}tuple}
\CommentTok{    \textgreater{}\textgreater{}\textgreater{} M = Mat((\{1,3,5\}, \{\textquotesingle{}a\textquotesingle{}\}), \{(1,\textquotesingle{}a\textquotesingle{}):4, (5,\textquotesingle{}a\textquotesingle{}): 2\})}
\CommentTok{    \textgreater{}\textgreater{}\textgreater{} M[1,\textquotesingle{}a\textquotesingle{}]}
\CommentTok{    4}
\CommentTok{    \textgreater{}\textgreater{}\textgreater{} M[3,\textquotesingle{}a\textquotesingle{}]}
\CommentTok{    0}
\CommentTok{    """}
    \ControlFlowTok{assert}\NormalTok{ k[}\DecValTok{0}\NormalTok{] }\KeywordTok{in}\NormalTok{ M.D[}\DecValTok{0}\NormalTok{] }\KeywordTok{and}\NormalTok{ k[}\DecValTok{1}\NormalTok{] }\KeywordTok{in}\NormalTok{ M.D[}\DecValTok{1}\NormalTok{]}
    \ControlFlowTok{return}\NormalTok{ M.f[k] }\ControlFlowTok{if}\NormalTok{ k }\KeywordTok{in}\NormalTok{ M.f.keys() }\ControlFlowTok{else} \DecValTok{0}
\KeywordTok{def}\NormalTok{ setitem(M, k, val):}
    \CommentTok{"""}
\CommentTok{    Set entry k of Mat M to val, where k is a 2{-}tuple.}
\CommentTok{    \textgreater{}\textgreater{}\textgreater{} M = Mat((\{\textquotesingle{}a\textquotesingle{},\textquotesingle{}b\textquotesingle{},\textquotesingle{}c\textquotesingle{}\}, \{5\}), \{(\textquotesingle{}a\textquotesingle{}, 5):3, (\textquotesingle{}b\textquotesingle{}, 5):7\})}
\CommentTok{    \textgreater{}\textgreater{}\textgreater{} M[\textquotesingle{}b\textquotesingle{}, 5] = 9}
\CommentTok{    \textgreater{}\textgreater{}\textgreater{} M[\textquotesingle{}c\textquotesingle{}, 5] = 13}
\CommentTok{    \textgreater{}\textgreater{}\textgreater{} M == Mat((\{\textquotesingle{}a\textquotesingle{},\textquotesingle{}b\textquotesingle{},\textquotesingle{}c\textquotesingle{}\}, \{5\}), \{(\textquotesingle{}a\textquotesingle{}, 5):3, (\textquotesingle{}b\textquotesingle{}, 5):9, (\textquotesingle{}c\textquotesingle{},5):13\})}
\CommentTok{    True}
\CommentTok{    \textgreater{}\textgreater{}\textgreater{} N = Mat((\{((),), 7\}, \{True, False\}), \{\})}
\CommentTok{    \textgreater{}\textgreater{}\textgreater{} N[(7, False)] = 1}
\CommentTok{    \textgreater{}\textgreater{}\textgreater{} N[(((),), True)] = 2}
\CommentTok{    \textgreater{}\textgreater{}\textgreater{} N == Mat((\{((),), 7\}, \{True, False\}), \{(7,False):1, (((),), True):2\})}
\CommentTok{    True}
\CommentTok{    """}
    \ControlFlowTok{assert}\NormalTok{ k[}\DecValTok{0}\NormalTok{] }\KeywordTok{in}\NormalTok{ M.D[}\DecValTok{0}\NormalTok{] }\KeywordTok{and}\NormalTok{ k[}\DecValTok{1}\NormalTok{] }\KeywordTok{in}\NormalTok{ M.D[}\DecValTok{1}\NormalTok{]}
\NormalTok{    M.f[k]}\OperatorTok{=}\NormalTok{val}

\KeywordTok{def}\NormalTok{ add(A, B):}
    \CommentTok{"""}
\CommentTok{    Return the sum of Mats A and B.}
\CommentTok{    \textgreater{}\textgreater{}\textgreater{} A1 = Mat((\{3, 6\}, \{\textquotesingle{}x\textquotesingle{},\textquotesingle{}y\textquotesingle{}\}), \{(3,\textquotesingle{}x\textquotesingle{}):{-}2, (6,\textquotesingle{}y\textquotesingle{}):3\})}
\CommentTok{    \textgreater{}\textgreater{}\textgreater{} A2 = Mat((\{3, 6\}, \{\textquotesingle{}x\textquotesingle{},\textquotesingle{}y\textquotesingle{}\}), \{(3,\textquotesingle{}y\textquotesingle{}):4\})}
\CommentTok{    \textgreater{}\textgreater{}\textgreater{} B = Mat((\{3, 6\}, \{\textquotesingle{}x\textquotesingle{},\textquotesingle{}y\textquotesingle{}\}), \{(3,\textquotesingle{}x\textquotesingle{}):{-}2, (3,\textquotesingle{}y\textquotesingle{}):4, (6,\textquotesingle{}y\textquotesingle{}):3\})}
\CommentTok{    \textgreater{}\textgreater{}\textgreater{} A1 + A2 == B}
\CommentTok{    True}
\CommentTok{    \textgreater{}\textgreater{}\textgreater{} A2 + A1 == B}
\CommentTok{    True}
\CommentTok{    \textgreater{}\textgreater{}\textgreater{} A1 == Mat((\{3, 6\}, \{\textquotesingle{}x\textquotesingle{},\textquotesingle{}y\textquotesingle{}\}), \{(3,\textquotesingle{}x\textquotesingle{}):{-}2, (6,\textquotesingle{}y\textquotesingle{}):3\})}
\CommentTok{    True}
\CommentTok{    \textgreater{}\textgreater{}\textgreater{} zero = Mat((\{3,6\}, \{\textquotesingle{}x\textquotesingle{},\textquotesingle{}y\textquotesingle{}\}), \{\})}
\CommentTok{    \textgreater{}\textgreater{}\textgreater{} B + zero == B}
\CommentTok{    True}
\CommentTok{    \textgreater{}\textgreater{}\textgreater{} C1 = Mat((\{1,3\}, \{2,4\}), \{(1,2):2, (3,4):3\})}
\CommentTok{    \textgreater{}\textgreater{}\textgreater{} C2 = Mat((\{1,3\}, \{2,4\}), \{(1,4):1, (1,2):4\})}
\CommentTok{    \textgreater{}\textgreater{}\textgreater{} D = Mat((\{1,3\}, \{2,4\}), \{(1,2):6, (1,4):1, (3,4):3\})}
\CommentTok{    \textgreater{}\textgreater{}\textgreater{} C1 + C2 == D}
\CommentTok{    True}
\CommentTok{    """}
    \ControlFlowTok{assert}\NormalTok{ A.D }\OperatorTok{==}\NormalTok{ B.D}
\NormalTok{    C}\OperatorTok{=}\NormalTok{A.copy()}
    \ControlFlowTok{for}\NormalTok{ row }\KeywordTok{in}\NormalTok{ A.D[}\DecValTok{0}\NormalTok{]:}
        \ControlFlowTok{for}\NormalTok{ col }\KeywordTok{in}\NormalTok{ A.D[}\DecValTok{1}\NormalTok{]:}
\NormalTok{            setitem(C, (row,col), getitem(A, (row,col))}\OperatorTok{+}\NormalTok{getitem(B, (row,col)))}
    \ControlFlowTok{return}\NormalTok{ C}
    
\KeywordTok{def}\NormalTok{ scalar\_mul(M, x):}
    \CommentTok{"""}
\CommentTok{    Returns the result of scaling M by x.}
\CommentTok{    \textgreater{}\textgreater{}\textgreater{} M = Mat((\{1,3,5\}, \{2,4\}), \{(1,2):4, (5,4):2, (3,4):3\})}
\CommentTok{    \textgreater{}\textgreater{}\textgreater{} 0*M == Mat((\{1, 3, 5\}, \{2, 4\}), \{\})}
\CommentTok{    True}
\CommentTok{    \textgreater{}\textgreater{}\textgreater{} 1*M == M}
\CommentTok{    True}
\CommentTok{    \textgreater{}\textgreater{}\textgreater{} 0.25*M == Mat((\{1,3,5\}, \{2,4\}), \{(1,2):1.0, (5,4):0.5, (3,4):0.75\})}
\CommentTok{    True}
\CommentTok{    """}
\NormalTok{    C}\OperatorTok{=}\NormalTok{M.copy()}
    \ControlFlowTok{for}\NormalTok{ row }\KeywordTok{in}\NormalTok{ M.D[}\DecValTok{0}\NormalTok{]:}
        \ControlFlowTok{for}\NormalTok{ col }\KeywordTok{in}\NormalTok{ M.D[}\DecValTok{1}\NormalTok{]:}
\NormalTok{            setitem(C, (row,col), x}\OperatorTok{*}\NormalTok{getitem(M, (row,col)))}
    \ControlFlowTok{return}\NormalTok{ C}

\KeywordTok{def}\NormalTok{ transpose(M):}
    \CommentTok{"""}
\CommentTok{    Returns the matrix that is the transpose of M.}
\CommentTok{    \textgreater{}\textgreater{}\textgreater{} M = Mat((\{0,1\}, \{0,1\}), \{(0,1):3, (1,0):2, (1,1):4\})}
\CommentTok{    \textgreater{}\textgreater{}\textgreater{} M.transpose() == Mat((\{0,1\}, \{0,1\}), \{(0,1):2, (1,0):3, (1,1):4\})}
\CommentTok{    True}
\CommentTok{    \textgreater{}\textgreater{}\textgreater{} M = Mat((\{\textquotesingle{}x\textquotesingle{},\textquotesingle{}y\textquotesingle{},\textquotesingle{}z\textquotesingle{}\}, \{2,4\}), \{(\textquotesingle{}x\textquotesingle{},4):3, (\textquotesingle{}x\textquotesingle{},2):2, (\textquotesingle{}y\textquotesingle{},4):4, (\textquotesingle{}z\textquotesingle{},4):5\})}
\CommentTok{    \textgreater{}\textgreater{}\textgreater{} Mt = Mat((\{2,4\}, \{\textquotesingle{}x\textquotesingle{},\textquotesingle{}y\textquotesingle{},\textquotesingle{}z\textquotesingle{}\}), \{(4,\textquotesingle{}x\textquotesingle{}):3, (2,\textquotesingle{}x\textquotesingle{}):2, (4,\textquotesingle{}y\textquotesingle{}):4, (4,\textquotesingle{}z\textquotesingle{}):5\})}
\CommentTok{    \textgreater{}\textgreater{}\textgreater{} M.transpose() == Mt}
\CommentTok{    True}
\CommentTok{    """}
\NormalTok{    C}\OperatorTok{=}\NormalTok{Mat((M.D[}\DecValTok{1}\NormalTok{], M.D[}\DecValTok{0}\NormalTok{]),\{\} )}
    \ControlFlowTok{for}\NormalTok{ row }\KeywordTok{in}\NormalTok{ M.D[}\DecValTok{0}\NormalTok{]:}
        \ControlFlowTok{for}\NormalTok{ col }\KeywordTok{in}\NormalTok{ M.D[}\DecValTok{1}\NormalTok{]:}
\NormalTok{            setitem(C, (col,row), getitem(M, (row,col)))}
    \ControlFlowTok{return}\NormalTok{ C}

\KeywordTok{def}\NormalTok{ vector\_matrix\_mul(v, M):}
    \CommentTok{"""}
\CommentTok{    returns the product of vector v and matrix M}
\CommentTok{    \textgreater{}\textgreater{}\textgreater{} v1 = Vec(\{1, 2, 3\}, \{1: 1, 2: 8\})}
\CommentTok{    \textgreater{}\textgreater{}\textgreater{} M1 = Mat((\{1, 2, 3\}, \{\textquotesingle{}a\textquotesingle{}, \textquotesingle{}b\textquotesingle{}, \textquotesingle{}c\textquotesingle{}\}), \{(1, \textquotesingle{}b\textquotesingle{}): 2, (2, \textquotesingle{}a\textquotesingle{}):{-}1, (3, \textquotesingle{}a\textquotesingle{}): 1, (3, \textquotesingle{}c\textquotesingle{}): 7\})}
\CommentTok{    \textgreater{}\textgreater{}\textgreater{} v1*M1 == Vec(\{\textquotesingle{}a\textquotesingle{}, \textquotesingle{}b\textquotesingle{}, \textquotesingle{}c\textquotesingle{}\},\{\textquotesingle{}a\textquotesingle{}: {-}8, \textquotesingle{}b\textquotesingle{}: 2, \textquotesingle{}c\textquotesingle{}: 0\})}
\CommentTok{    True}
\CommentTok{    \textgreater{}\textgreater{}\textgreater{} v1 == Vec(\{1, 2, 3\}, \{1: 1, 2: 8\})}
\CommentTok{    True}
\CommentTok{    \textgreater{}\textgreater{}\textgreater{} M1 == Mat((\{1, 2, 3\}, \{\textquotesingle{}a\textquotesingle{}, \textquotesingle{}b\textquotesingle{}, \textquotesingle{}c\textquotesingle{}\}), \{(1, \textquotesingle{}b\textquotesingle{}): 2, (2, \textquotesingle{}a\textquotesingle{}):{-}1, (3, \textquotesingle{}a\textquotesingle{}): 1, (3, \textquotesingle{}c\textquotesingle{}): 7\})}
\CommentTok{    True}
\CommentTok{    \textgreater{}\textgreater{}\textgreater{} v2 = Vec(\{\textquotesingle{}a\textquotesingle{},\textquotesingle{}b\textquotesingle{}\}, \{\})}
\CommentTok{    \textgreater{}\textgreater{}\textgreater{} M2 = Mat((\{\textquotesingle{}a\textquotesingle{},\textquotesingle{}b\textquotesingle{}\}, \{0, 2, 4, 6, 7\}), \{\})}
\CommentTok{    \textgreater{}\textgreater{}\textgreater{} v2*M2 == Vec(\{0, 2, 4, 6, 7\},\{\})}
\CommentTok{    True}
\CommentTok{    """}
    \ControlFlowTok{assert}\NormalTok{ M.D[}\DecValTok{0}\NormalTok{] }\OperatorTok{==}\NormalTok{ v.D}
\NormalTok{    v\_tmp }\OperatorTok{=}\NormalTok{ Vec(M.D[}\DecValTok{1}\NormalTok{], \{\})}
    \ControlFlowTok{for}\NormalTok{ col }\KeywordTok{in}\NormalTok{ v\_tmp.D:}
        \ControlFlowTok{for}\NormalTok{ row }\KeywordTok{in}\NormalTok{ M.D[}\DecValTok{0}\NormalTok{]:}
\NormalTok{            v\_tmp[col] }\OperatorTok{=}\NormalTok{ v\_tmp[col] }\OperatorTok{+}\NormalTok{ getitem(M,(row,col)) }\OperatorTok{*}\NormalTok{ v[row] }
    \ControlFlowTok{return}\NormalTok{ v\_tmp}

\KeywordTok{def}\NormalTok{ matrix\_vector\_mul(M, v):}
    \CommentTok{"""}
\CommentTok{    Returns the product of matrix M and vector v.}
\CommentTok{    \textgreater{}\textgreater{}\textgreater{} N1 = Mat((\{1, 3, 5, 7\}, \{\textquotesingle{}a\textquotesingle{}, \textquotesingle{}b\textquotesingle{}\}), \{(1, \textquotesingle{}a\textquotesingle{}): {-}1, (1, \textquotesingle{}b\textquotesingle{}): 2, (3, \textquotesingle{}a\textquotesingle{}): 1, (3, \textquotesingle{}b\textquotesingle{}):4, (7, \textquotesingle{}a\textquotesingle{}): 3, (5, \textquotesingle{}b\textquotesingle{}):{-}1\})}
\CommentTok{    \textgreater{}\textgreater{}\textgreater{} u1 = Vec(\{\textquotesingle{}a\textquotesingle{}, \textquotesingle{}b\textquotesingle{}\}, \{\textquotesingle{}a\textquotesingle{}: 1, \textquotesingle{}b\textquotesingle{}: 2\})}
\CommentTok{    \textgreater{}\textgreater{}\textgreater{} N1*u1 == Vec(\{1, 3, 5, 7\},\{1: 3, 3: 9, 5: {-}2, 7: 3\})}
\CommentTok{    True}
\CommentTok{    \textgreater{}\textgreater{}\textgreater{} N1 == Mat((\{1, 3, 5, 7\}, \{\textquotesingle{}a\textquotesingle{}, \textquotesingle{}b\textquotesingle{}\}), \{(1, \textquotesingle{}a\textquotesingle{}): {-}1, (1, \textquotesingle{}b\textquotesingle{}): 2, (3, \textquotesingle{}a\textquotesingle{}): 1, (3, \textquotesingle{}b\textquotesingle{}):4, (7, \textquotesingle{}a\textquotesingle{}): 3, (5, \textquotesingle{}b\textquotesingle{}):{-}1\})}
\CommentTok{    True}
\CommentTok{    \textgreater{}\textgreater{}\textgreater{} u1 == Vec(\{\textquotesingle{}a\textquotesingle{}, \textquotesingle{}b\textquotesingle{}\}, \{\textquotesingle{}a\textquotesingle{}: 1, \textquotesingle{}b\textquotesingle{}: 2\})}
\CommentTok{    True}
\CommentTok{    \textgreater{}\textgreater{}\textgreater{} N2 = Mat((\{(\textquotesingle{}a\textquotesingle{}, \textquotesingle{}b\textquotesingle{}), (\textquotesingle{}c\textquotesingle{}, \textquotesingle{}d\textquotesingle{})\}, \{1, 2, 3, 5, 8\}), \{\})}
\CommentTok{    \textgreater{}\textgreater{}\textgreater{} u2 = Vec(\{1, 2, 3, 5, 8\}, \{\})}
\CommentTok{    \textgreater{}\textgreater{}\textgreater{} N2*u2 == Vec(\{(\textquotesingle{}a\textquotesingle{}, \textquotesingle{}b\textquotesingle{}), (\textquotesingle{}c\textquotesingle{}, \textquotesingle{}d\textquotesingle{})\},\{\})}
\CommentTok{    True}
\CommentTok{    """}
    \ControlFlowTok{assert}\NormalTok{ M.D[}\DecValTok{1}\NormalTok{] }\OperatorTok{==}\NormalTok{ v.D}
\NormalTok{    v\_tmp }\OperatorTok{=}\NormalTok{ Vec(M.D[}\DecValTok{0}\NormalTok{], \{\})}
    \ControlFlowTok{for}\NormalTok{ row }\KeywordTok{in}\NormalTok{ v\_tmp.D:}
        \ControlFlowTok{for}\NormalTok{ col }\KeywordTok{in}\NormalTok{ M.D[}\DecValTok{1}\NormalTok{]:}
\NormalTok{            v\_tmp[row] }\OperatorTok{=}\NormalTok{ v\_tmp[row] }\OperatorTok{+}\NormalTok{ getitem(M,(row,col)) }\OperatorTok{*}\NormalTok{ v[col] }
    \ControlFlowTok{return}\NormalTok{ v\_tmp}

\KeywordTok{def}\NormalTok{ matrix\_matrix\_mul(A, B):}
    \CommentTok{"""}
\CommentTok{    Returns the result of the matrix{-}matrix multiplication, A*B.}
\CommentTok{    \textgreater{}\textgreater{}\textgreater{} A = Mat((\{0,1,2\}, \{0,1,2\}), \{(1,1):4, (0,0):0, (1,2):1, (1,0):5, (0,1):3, (0,2):2\})}
\CommentTok{    \textgreater{}\textgreater{}\textgreater{} B = Mat((\{0,1,2\}, \{0,1,2\}), \{(1,0):5, (2,1):3, (1,1):2, (2,0):0, (0,0):1, (0,1):4\})}
\CommentTok{    \textgreater{}\textgreater{}\textgreater{} A*B == Mat((\{0,1,2\}, \{0,1,2\}), \{(0,0):15, (0,1):12, (1,0):25, (1,1):31\})}
\CommentTok{    True}
\CommentTok{    \textgreater{}\textgreater{}\textgreater{} C = Mat((\{0,1,2\}, \{\textquotesingle{}a\textquotesingle{},\textquotesingle{}b\textquotesingle{}\}), \{(0,\textquotesingle{}a\textquotesingle{}):4, (0,\textquotesingle{}b\textquotesingle{}):{-}3, (1,\textquotesingle{}a\textquotesingle{}):1, (2,\textquotesingle{}a\textquotesingle{}):1, (2,\textquotesingle{}b\textquotesingle{}):{-}2\})}
\CommentTok{    \textgreater{}\textgreater{}\textgreater{} D = Mat((\{\textquotesingle{}a\textquotesingle{},\textquotesingle{}b\textquotesingle{}\}, \{\textquotesingle{}x\textquotesingle{},\textquotesingle{}y\textquotesingle{}\}), \{(\textquotesingle{}a\textquotesingle{},\textquotesingle{}x\textquotesingle{}):3, (\textquotesingle{}a\textquotesingle{},\textquotesingle{}y\textquotesingle{}):{-}2, (\textquotesingle{}b\textquotesingle{},\textquotesingle{}x\textquotesingle{}):4, (\textquotesingle{}b\textquotesingle{},\textquotesingle{}y\textquotesingle{}):{-}1\})}
\CommentTok{    \textgreater{}\textgreater{}\textgreater{} C*D == Mat((\{0,1,2\}, \{\textquotesingle{}x\textquotesingle{},\textquotesingle{}y\textquotesingle{}\}), \{(0,\textquotesingle{}y\textquotesingle{}):{-}5, (1,\textquotesingle{}x\textquotesingle{}):3, (1,\textquotesingle{}y\textquotesingle{}):{-}2, (2,\textquotesingle{}x\textquotesingle{}):{-}5\})}
\CommentTok{    True}
\CommentTok{    \textgreater{}\textgreater{}\textgreater{} M = Mat((\{0, 1\}, \{\textquotesingle{}a\textquotesingle{}, \textquotesingle{}c\textquotesingle{}, \textquotesingle{}b\textquotesingle{}\}), \{\})}
\CommentTok{    \textgreater{}\textgreater{}\textgreater{} N = Mat((\{\textquotesingle{}a\textquotesingle{}, \textquotesingle{}c\textquotesingle{}, \textquotesingle{}b\textquotesingle{}\}, \{(1, 1), (2, 2)\}), \{\})}
\CommentTok{    \textgreater{}\textgreater{}\textgreater{} M*N == Mat((\{0,1\}, \{(1,1), (2,2)\}), \{\})}
\CommentTok{    True}
\CommentTok{    \textgreater{}\textgreater{}\textgreater{} E = Mat((\{\textquotesingle{}a\textquotesingle{},\textquotesingle{}b\textquotesingle{}\},\{\textquotesingle{}A\textquotesingle{},\textquotesingle{}B\textquotesingle{}\}), \{(\textquotesingle{}a\textquotesingle{},\textquotesingle{}A\textquotesingle{}):1,(\textquotesingle{}a\textquotesingle{},\textquotesingle{}B\textquotesingle{}):2,(\textquotesingle{}b\textquotesingle{},\textquotesingle{}A\textquotesingle{}):3,(\textquotesingle{}b\textquotesingle{},\textquotesingle{}B\textquotesingle{}):4\})}
\CommentTok{    \textgreater{}\textgreater{}\textgreater{} F = Mat((\{\textquotesingle{}A\textquotesingle{},\textquotesingle{}B\textquotesingle{}\},\{\textquotesingle{}c\textquotesingle{},\textquotesingle{}d\textquotesingle{}\}),\{(\textquotesingle{}A\textquotesingle{},\textquotesingle{}d\textquotesingle{}):5\})}
\CommentTok{    \textgreater{}\textgreater{}\textgreater{} E*F == Mat((\{\textquotesingle{}a\textquotesingle{}, \textquotesingle{}b\textquotesingle{}\}, \{\textquotesingle{}d\textquotesingle{}, \textquotesingle{}c\textquotesingle{}\}), \{(\textquotesingle{}b\textquotesingle{}, \textquotesingle{}d\textquotesingle{}): 15, (\textquotesingle{}a\textquotesingle{}, \textquotesingle{}d\textquotesingle{}): 5\})}
\CommentTok{    True}
\CommentTok{    \textgreater{}\textgreater{}\textgreater{} F.transpose()*E.transpose() == Mat((\{\textquotesingle{}d\textquotesingle{}, \textquotesingle{}c\textquotesingle{}\}, \{\textquotesingle{}a\textquotesingle{}, \textquotesingle{}b\textquotesingle{}\}), \{(\textquotesingle{}d\textquotesingle{}, \textquotesingle{}b\textquotesingle{}): 15, (\textquotesingle{}d\textquotesingle{}, \textquotesingle{}a\textquotesingle{}): 5\})}
\CommentTok{    True}
\CommentTok{    """}
    \ControlFlowTok{assert}\NormalTok{ A.D[}\DecValTok{1}\NormalTok{] }\OperatorTok{==}\NormalTok{ B.D[}\DecValTok{0}\NormalTok{]}
\NormalTok{    M}\OperatorTok{=}\NormalTok{Mat((A.D[}\DecValTok{0}\NormalTok{], B.D[}\DecValTok{1}\NormalTok{]), \{\})}
    \ControlFlowTok{for}\NormalTok{ col }\KeywordTok{in}\NormalTok{ B.D[}\DecValTok{1}\NormalTok{]:}
        \ControlFlowTok{for}\NormalTok{ row }\KeywordTok{in}\NormalTok{ A.D[}\DecValTok{0}\NormalTok{]:}
\NormalTok{            v\_tmp }\OperatorTok{=}\NormalTok{ Vec(B.D[}\DecValTok{0}\NormalTok{], \{\})}
            \ControlFlowTok{for}\NormalTok{ row\_t }\KeywordTok{in}\NormalTok{ B.D[}\DecValTok{0}\NormalTok{]:}
\NormalTok{                v\_tmp[row\_t]}\OperatorTok{=}\NormalTok{getitem(B, (row\_t, col))}
\NormalTok{            v }\OperatorTok{=}\NormalTok{ matrix\_vector\_mul(A, v\_tmp)}
\NormalTok{            setitem(M,(row, col), v[row]) }
    \ControlFlowTok{return}\NormalTok{ M}

\CommentTok{\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#}

\KeywordTok{class}\NormalTok{ Mat:}
    \KeywordTok{def} \FunctionTok{\_\_init\_\_}\NormalTok{(}\VariableTok{self}\NormalTok{, labels, function):}
        \ControlFlowTok{assert} \BuiltInTok{isinstance}\NormalTok{(labels, }\BuiltInTok{tuple}\NormalTok{)}
        \ControlFlowTok{assert} \BuiltInTok{isinstance}\NormalTok{(labels[}\DecValTok{0}\NormalTok{], }\BuiltInTok{set}\NormalTok{) }\KeywordTok{and} \BuiltInTok{isinstance}\NormalTok{(labels[}\DecValTok{1}\NormalTok{], }\BuiltInTok{set}\NormalTok{)}
        \ControlFlowTok{assert} \BuiltInTok{isinstance}\NormalTok{(function, }\BuiltInTok{dict}\NormalTok{)}
        \VariableTok{self}\NormalTok{.D }\OperatorTok{=}\NormalTok{ labels}
        \VariableTok{self}\NormalTok{.f }\OperatorTok{=}\NormalTok{ function}

    \FunctionTok{\_\_getitem\_\_} \OperatorTok{=}\NormalTok{ getitem}
    \FunctionTok{\_\_setitem\_\_} \OperatorTok{=}\NormalTok{ setitem}
\NormalTok{    transpose }\OperatorTok{=}\NormalTok{ transpose}

    \KeywordTok{def} \FunctionTok{\_\_neg\_\_}\NormalTok{(}\VariableTok{self}\NormalTok{):}
        \ControlFlowTok{return}\NormalTok{ (}\OperatorTok{{-}}\DecValTok{1}\NormalTok{)}\OperatorTok{*}\VariableTok{self}

    \KeywordTok{def} \FunctionTok{\_\_mul\_\_}\NormalTok{(}\VariableTok{self}\NormalTok{,other):}
        \ControlFlowTok{if}\NormalTok{ Mat }\OperatorTok{==} \BuiltInTok{type}\NormalTok{(other):}
            \ControlFlowTok{return}\NormalTok{ matrix\_matrix\_mul(}\VariableTok{self}\NormalTok{,other)}
        \ControlFlowTok{elif}\NormalTok{ Vec }\OperatorTok{==} \BuiltInTok{type}\NormalTok{(other):}
            \ControlFlowTok{return}\NormalTok{ matrix\_vector\_mul(}\VariableTok{self}\NormalTok{,other)}
        \ControlFlowTok{else}\NormalTok{:}
            \ControlFlowTok{return}\NormalTok{ scalar\_mul(}\VariableTok{self}\NormalTok{,other)}
            \CommentTok{\#this will only be used if other is scalar (or not{-}supported). mat and vec both have \_\_mul\_\_ implemented}

    \KeywordTok{def} \FunctionTok{\_\_rmul\_\_}\NormalTok{(}\VariableTok{self}\NormalTok{, other):}
        \ControlFlowTok{if}\NormalTok{ Vec }\OperatorTok{==} \BuiltInTok{type}\NormalTok{(other):}
            \ControlFlowTok{return}\NormalTok{ vector\_matrix\_mul(other, }\VariableTok{self}\NormalTok{)}
        \ControlFlowTok{else}\NormalTok{:  }\CommentTok{\# Assume scalar}
            \ControlFlowTok{return}\NormalTok{ scalar\_mul(}\VariableTok{self}\NormalTok{, other)}

    \FunctionTok{\_\_add\_\_} \OperatorTok{=}\NormalTok{ add}

    \KeywordTok{def} \FunctionTok{\_\_radd\_\_}\NormalTok{(}\VariableTok{self}\NormalTok{, other):}
        \CommentTok{"Hack to allow sum(...) to work with matrices"}
        \ControlFlowTok{if}\NormalTok{ other }\OperatorTok{==} \DecValTok{0}\NormalTok{:}
            \ControlFlowTok{return} \VariableTok{self}

    \KeywordTok{def} \FunctionTok{\_\_sub\_\_}\NormalTok{(a,b):}
        \ControlFlowTok{return}\NormalTok{ a}\OperatorTok{+}\NormalTok{(}\OperatorTok{{-}}\NormalTok{b)}

    \FunctionTok{\_\_eq\_\_} \OperatorTok{=}\NormalTok{ equal}

    \KeywordTok{def}\NormalTok{ copy(}\VariableTok{self}\NormalTok{):}
        \ControlFlowTok{return}\NormalTok{ Mat(}\VariableTok{self}\NormalTok{.D, }\VariableTok{self}\NormalTok{.f.copy())}

    \KeywordTok{def} \FunctionTok{\_\_str\_\_}\NormalTok{(M, rows}\OperatorTok{=}\VariableTok{None}\NormalTok{, cols}\OperatorTok{=}\VariableTok{None}\NormalTok{):}
        \CommentTok{"string representation for print()"}
        \ControlFlowTok{if}\NormalTok{ rows }\OperatorTok{==} \VariableTok{None}\NormalTok{: rows }\OperatorTok{=} \BuiltInTok{sorted}\NormalTok{(M.D[}\DecValTok{0}\NormalTok{], key}\OperatorTok{=}\BuiltInTok{repr}\NormalTok{)}
        \ControlFlowTok{if}\NormalTok{ cols }\OperatorTok{==} \VariableTok{None}\NormalTok{: cols }\OperatorTok{=} \BuiltInTok{sorted}\NormalTok{(M.D[}\DecValTok{1}\NormalTok{], key}\OperatorTok{=}\BuiltInTok{repr}\NormalTok{)}
\NormalTok{        separator }\OperatorTok{=} \StringTok{\textquotesingle{} | \textquotesingle{}}
\NormalTok{        numdec }\OperatorTok{=} \DecValTok{3}
\NormalTok{        pre }\OperatorTok{=} \DecValTok{1}\OperatorTok{+}\BuiltInTok{max}\NormalTok{([}\BuiltInTok{len}\NormalTok{(}\BuiltInTok{str}\NormalTok{(r)) }\ControlFlowTok{for}\NormalTok{ r }\KeywordTok{in}\NormalTok{ rows])}
\NormalTok{        colw }\OperatorTok{=}\NormalTok{ \{col:(}\DecValTok{1}\OperatorTok{+}\BuiltInTok{max}\NormalTok{([}\BuiltInTok{len}\NormalTok{(}\BuiltInTok{str}\NormalTok{(col))] }\OperatorTok{+}\NormalTok{ [}\BuiltInTok{len}\NormalTok{(}\StringTok{\textquotesingle{}\{0:.}\SpecialCharTok{\{1\}}\StringTok{G\}\textquotesingle{}}\NormalTok{.}\BuiltInTok{format}\NormalTok{(M[row,col],numdec)) }\ControlFlowTok{if} \BuiltInTok{isinstance}\NormalTok{(M[row,col], }\BuiltInTok{int}\NormalTok{) }\KeywordTok{or} \BuiltInTok{isinstance}\NormalTok{(M[row,col], }\BuiltInTok{float}\NormalTok{) }\ControlFlowTok{else} \BuiltInTok{len}\NormalTok{(}\BuiltInTok{str}\NormalTok{(M[row,col])) }\ControlFlowTok{for}\NormalTok{ row }\KeywordTok{in}\NormalTok{ rows])) }\ControlFlowTok{for}\NormalTok{ col }\KeywordTok{in}\NormalTok{ cols\}}
\NormalTok{        s1 }\OperatorTok{=} \StringTok{\textquotesingle{} \textquotesingle{}}\OperatorTok{*}\NormalTok{(}\DecValTok{1}\OperatorTok{+}\NormalTok{ pre }\OperatorTok{+} \BuiltInTok{len}\NormalTok{(separator))}
\NormalTok{        s2 }\OperatorTok{=} \StringTok{\textquotesingle{}\textquotesingle{}}\NormalTok{.join([}\StringTok{\textquotesingle{}\{0:\textgreater{}}\SpecialCharTok{\{1\}}\StringTok{\}\textquotesingle{}}\NormalTok{.}\BuiltInTok{format}\NormalTok{(}\BuiltInTok{str}\NormalTok{(c),colw[c]) }\ControlFlowTok{for}\NormalTok{ c }\KeywordTok{in}\NormalTok{ cols])}
\NormalTok{        s3 }\OperatorTok{=} \StringTok{\textquotesingle{} \textquotesingle{}}\OperatorTok{*}\NormalTok{(pre}\OperatorTok{+}\BuiltInTok{len}\NormalTok{(separator)) }\OperatorTok{+} \StringTok{\textquotesingle{}{-}\textquotesingle{}}\OperatorTok{*}\NormalTok{(}\BuiltInTok{sum}\NormalTok{(}\BuiltInTok{list}\NormalTok{(colw.values())) }\OperatorTok{+} \DecValTok{1}\NormalTok{)}
\NormalTok{        s4 }\OperatorTok{=} \StringTok{\textquotesingle{}\textquotesingle{}}\NormalTok{.join([}\StringTok{\textquotesingle{}\{0:\textgreater{}}\SpecialCharTok{\{1\}}\StringTok{\} }\SpecialCharTok{\{2\}}\StringTok{\textquotesingle{}}\NormalTok{.}\BuiltInTok{format}\NormalTok{(}\BuiltInTok{str}\NormalTok{(r), pre,separator)}\OperatorTok{+}\StringTok{\textquotesingle{}\textquotesingle{}}\NormalTok{.join([}\StringTok{\textquotesingle{}\{0:\textgreater{}}\SpecialCharTok{\{1\}}\StringTok{.}\SpecialCharTok{\{2\}}\StringTok{G\}\textquotesingle{}}\NormalTok{.}\BuiltInTok{format}\NormalTok{(M[r,c],colw[c],numdec) }\ControlFlowTok{if} \BuiltInTok{isinstance}\NormalTok{(M[r,c], }\BuiltInTok{int}\NormalTok{) }\KeywordTok{or} \BuiltInTok{isinstance}\NormalTok{(M[r,c], }\BuiltInTok{float}\NormalTok{) }\ControlFlowTok{else} \StringTok{\textquotesingle{}\{0:\textgreater{}}\SpecialCharTok{\{1\}}\StringTok{\}\textquotesingle{}}\NormalTok{.}\BuiltInTok{format}\NormalTok{(M[r,c], colw[c]) }\ControlFlowTok{for}\NormalTok{ c }\KeywordTok{in}\NormalTok{ cols])}\OperatorTok{+}\StringTok{\textquotesingle{}}\CharTok{\textbackslash{}n}\StringTok{\textquotesingle{}} \ControlFlowTok{for}\NormalTok{ r }\KeywordTok{in}\NormalTok{ rows])}
        \ControlFlowTok{return} \StringTok{\textquotesingle{}}\CharTok{\textbackslash{}n}\StringTok{\textquotesingle{}} \OperatorTok{+}\NormalTok{ s1 }\OperatorTok{+}\NormalTok{ s2 }\OperatorTok{+} \StringTok{\textquotesingle{}}\CharTok{\textbackslash{}n}\StringTok{\textquotesingle{}} \OperatorTok{+}\NormalTok{ s3 }\OperatorTok{+} \StringTok{\textquotesingle{}}\CharTok{\textbackslash{}n}\StringTok{\textquotesingle{}} \OperatorTok{+}\NormalTok{ s4}

    \KeywordTok{def}\NormalTok{ pp(}\VariableTok{self}\NormalTok{, rows, cols):}
        \BuiltInTok{print}\NormalTok{(}\VariableTok{self}\NormalTok{.}\FunctionTok{\_\_str\_\_}\NormalTok{(rows, cols))}

    \KeywordTok{def} \FunctionTok{\_\_repr\_\_}\NormalTok{(}\VariableTok{self}\NormalTok{):}
        \CommentTok{"evaluatable representation"}
        \ControlFlowTok{return} \StringTok{"Mat("} \OperatorTok{+} \BuiltInTok{str}\NormalTok{(}\VariableTok{self}\NormalTok{.D) }\OperatorTok{+}\StringTok{", "} \OperatorTok{+} \BuiltInTok{str}\NormalTok{(}\VariableTok{self}\NormalTok{.f) }\OperatorTok{+} \StringTok{")"}

    \KeywordTok{def} \FunctionTok{\_\_iter\_\_}\NormalTok{(}\VariableTok{self}\NormalTok{):}
        \ControlFlowTok{raise} \PreprocessorTok{TypeError}\NormalTok{(}\StringTok{\textquotesingle{}}\SpecialCharTok{\%r}\StringTok{ object is not iterable\textquotesingle{}} \OperatorTok{\%} \VariableTok{self}\NormalTok{.\_\_class\_\_.}\VariableTok{\_\_name\_\_}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\hypertarget{testing-mat.py}{%
\subsubsection{\texorpdfstring{Testing
\texttt{mat.py}}{Testing mat.py}}\label{testing-mat.py}}

\begin{Shaded}
\begin{Highlighting}[numbers=left,,]
\ImportTok{import}\NormalTok{ subprocess}
\NormalTok{subprocess.run([}\StringTok{"python"}\NormalTok{, }\StringTok{"{-}m"}\NormalTok{, }\StringTok{"doctest"}\NormalTok{, }\StringTok{"mat.py"}\NormalTok{], check}\OperatorTok{=}\VariableTok{True}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
CompletedProcess(args=['python', '-m', 'doctest', 'mat.py'], returncode=0)
\end{verbatim}

Note that a \texttt{returncode} of 0 means that all of the testcases
executed successfully.

\newpage{}

\hypertarget{matrix-vector-and-vector-matrix-multiplication-definitions-in-python}{%
\section{Matrix-vector and vector-matrix multiplication definitions in
Python}\label{matrix-vector-and-vector-matrix-multiplication-definitions-in-python}}

You will write several procedures, each implementing matrix-vector
multiplication using a \emph{specified definition} of matrix-vector
multiplication or vector-matrix multiplication.

\begin{itemize}
\item These procedures can be written and run after you write \verb|getitem(M, k)| but before you make any other additions to \verb|Mat|.
\item These procedures must \textit{not} be designed to exploit sparsity.
\item Your code must \textit{not} use the matrix-vector and vector-matrix multiplication operations that are not part of \verb|Mat|.
\item Your code should use procedures \verb|mat2rowdict, mat2coldict, rowdict2mat(rowdict)|, and/or \verb|coldict2mat(coldict)| from the \verb|matutil| module.
\end{itemize}

\hypertarget{problem-4.17.13}{%
\subsection{Problem 4.17.13}\label{problem-4.17.13}}

Write the procedure \texttt{lin\_comb\_mat\_vec\_mult(M,\ v)}, which
multiplies \texttt{M} times \texttt{v} using the linear-combination
definition. For this problem, the only operation on \texttt{v} you are
allowed is getting the value of an entry using brackets:
\texttt{v{[}k{]}}. The vector returned must be computed as a linear
combination.

\begin{Shaded}
\begin{Highlighting}[numbers=left,,]
\KeywordTok{def}\NormalTok{ lin\_comb\_mat\_vec\_mult(M, v):}
\NormalTok{    colDict }\OperatorTok{=}\NormalTok{ mat2coldict(M)}
\NormalTok{    res }\OperatorTok{=}\NormalTok{ Vec(M.D[}\DecValTok{0}\NormalTok{],\{\})}
    \ControlFlowTok{for}\NormalTok{ col }\KeywordTok{in}\NormalTok{ v.D:}
\NormalTok{        res }\OperatorTok{=}\NormalTok{ res }\OperatorTok{+}\NormalTok{ v[col] }\OperatorTok{*}\NormalTok{ colDict[col]}
    \ControlFlowTok{return}\NormalTok{ res}
\end{Highlighting}
\end{Shaded}

\hypertarget{problem-4.17.14}{%
\subsection{Problem 4.17.14}\label{problem-4.17.14}}

Write \texttt{lin\_comb\_vec\_mat\_mult(v,\ M)}, which multiply
\texttt{v} times \texttt{M} using the linear-combination definition. For
this problem, the only operation on \texttt{v} you are allowed is
getting the value of an entry using brackets: \texttt{v{[}k{]}}. The
vector returned must be computed as a linear combination.

\begin{Shaded}
\begin{Highlighting}[numbers=left,,]
\KeywordTok{def}\NormalTok{ lin\_comb\_vec\_mat\_mult(v, M):}
\NormalTok{  rowDict }\OperatorTok{=}\NormalTok{ mat2rowdict(M)}
\NormalTok{  res }\OperatorTok{=}\NormalTok{ Vec(M.D[}\DecValTok{1}\NormalTok{],\{\})}
  \ControlFlowTok{for}\NormalTok{ col }\KeywordTok{in}\NormalTok{ v.D:}
\NormalTok{      res }\OperatorTok{=}\NormalTok{ res }\OperatorTok{+}\NormalTok{ v[col] }\OperatorTok{*}\NormalTok{ rowDict[col]}
  \ControlFlowTok{return}\NormalTok{ res}
\end{Highlighting}
\end{Shaded}

\hypertarget{problem-4.17.15}{%
\subsection{Problem 4.17.15}\label{problem-4.17.15}}

Write \texttt{dot\_product\_mat\_vec\_mult(M,\ v)}, which multiplies
\texttt{M} times \texttt{v} using the dot-product definition. For this
problem, the only operation on \texttt{v} you are allowed is taking the
dot-product of \texttt{v} and another vector and \texttt{v}:
\texttt{u*v} or \texttt{v*u}. The entries of the vector returned must be
computed using dot-product.

\begin{Shaded}
\begin{Highlighting}[numbers=left,,]
\KeywordTok{def}\NormalTok{ dot\_product\_mat\_vec\_mult(M, v):}
\NormalTok{    res }\OperatorTok{=}\NormalTok{ Vec(M.D[}\DecValTok{0}\NormalTok{], \{\})}
\NormalTok{    rowDict }\OperatorTok{=}\NormalTok{ mat2rowdict(M)}
    \ControlFlowTok{for}\NormalTok{ row }\KeywordTok{in}\NormalTok{ M.D[}\DecValTok{0}\NormalTok{]:}
\NormalTok{        res[row]}\OperatorTok{=}\NormalTok{ rowDict[row] }\OperatorTok{*}\NormalTok{ v}
    \ControlFlowTok{return}\NormalTok{ res}
\end{Highlighting}
\end{Shaded}

\hypertarget{problem-4.17.16}{%
\subsection{Problem 4.17.16}\label{problem-4.17.16}}

Write \texttt{dot\_product\_vec\_mat\_mult(v,\ M)}, which multiplies
\texttt{v} times \texttt{M} using the dot-product definition. For this
problem, the only operation on \texttt{v} you are allowed is taking the
dot-product of \texttt{v} and another vector and \texttt{v}:
\texttt{u*v} or \texttt{v*u}. The entries of the vector returned must be
computed using the dot-product.

\begin{Shaded}
\begin{Highlighting}[numbers=left,,]
\KeywordTok{def}\NormalTok{ dot\_product\_vec\_mat\_mult(v, M):}
\NormalTok{  res }\OperatorTok{=}\NormalTok{ Vec(M.D[}\DecValTok{1}\NormalTok{], \{\})}
\NormalTok{  colDict }\OperatorTok{=}\NormalTok{ mat2coldict(M)}
  \ControlFlowTok{for}\NormalTok{ col }\KeywordTok{in}\NormalTok{ M.D[}\DecValTok{1}\NormalTok{]:}
\NormalTok{      res[col] }\OperatorTok{=}\NormalTok{ colDict[col] }\OperatorTok{*}\NormalTok{ v}
    \ControlFlowTok{return}\NormalTok{ res}
\end{Highlighting}
\end{Shaded}

\newpage{}

\hypertarget{matrix-matrix-multiplication-in-python}{%
\section{Matrix-matrix multiplication in
Python}\label{matrix-matrix-multiplication-in-python}}

You will write several procedures, each implementing matrix-matrix
multiplication using a \emph{specified definition} of matrix-matrix
multiplication.

\begin{itemize}
\item These procedures can be written and run only after you have written and tested the procedures in \verb|mat.py| that perform matrix-vector and vector-matrix multiplication.
\item These procedures must \textit{not} be designed to exploit sparsity.
\item Your code must \textit{not} use the matrix-matrix multiplication that is part of \verb|Mat|. For this reason, you can write these procedures before completing that part of \verb|Mat|.
\item Your code should use the procedures \verb|mat2rowdict, mat2coldict, rowdict2mat(rowdict)|, and/or \verb|coldict2mat(coldict)| from the \verb|matutil| module.
\end{itemize}

\hypertarget{problem-4.17.17}{%
\subsection{Problem 4.17.17}\label{problem-4.17.17}}

Write \texttt{Mv\_mat\_mat\_mult(A,\ B)} to compute the matrix-matrix
product \texttt{A*B}, using the matrix-vector multiplication definition
of matrix-matrix multiplication. For this procedure, the only operation
you are allowed to do on \texttt{A} is matrix-vector multiplication,
using the \texttt{*} operator: \texttt{A*v}. Do \emph{not} use the named
procedure \texttt{matrix\_vector\_mul} or any of the procedures defined
in the previous problem.

\begin{Shaded}
\begin{Highlighting}[numbers=left,,]
\KeywordTok{def}\NormalTok{ Mv\_mat\_mat\_mult(A, B):}
\NormalTok{  colDict }\OperatorTok{=}\NormalTok{ mat2coldict(B)}
\NormalTok{  res}\OperatorTok{=}\BuiltInTok{dict}\NormalTok{()}
  \ControlFlowTok{for}\NormalTok{ col }\KeywordTok{in}\NormalTok{ colDict.keys():}
\NormalTok{      res[col]}\OperatorTok{=}\NormalTok{A}\OperatorTok{*}\NormalTok{colDict[col]}
  \ControlFlowTok{return}\NormalTok{ coldict2mat(res)}
\end{Highlighting}
\end{Shaded}

\hypertarget{problem-4.17.18}{%
\subsection{Problem 4.17.18}\label{problem-4.17.18}}

Write \texttt{vM\_mat\_mat\_mult(A,\ B)} to compute the matrix-matrix
product \texttt{A*B}, using the vector-matrix definition. For this
procedure, the only operation you are allowed to do on \texttt{B} is
vector-matrix multiplication, using the \texttt{*} operator:
\texttt{v*B}. Do \emph{not} use the named procedure
\texttt{vector\_matrix\_mul} or any of the procedures defined in the
previous problem.

\begin{Shaded}
\begin{Highlighting}[numbers=left,,]
\KeywordTok{def}\NormalTok{ vM\_mat\_mat\_mult(A, B):}
\NormalTok{  rowDict}\OperatorTok{=}\NormalTok{mat2rowdict(A)}
\NormalTok{  res}\OperatorTok{=}\BuiltInTok{dict}\NormalTok{()}
  \ControlFlowTok{for}\NormalTok{ row }\KeywordTok{in}\NormalTok{ rowDict.keys():}
\NormalTok{    res[row]}\OperatorTok{=}\NormalTok{rowDict[row]}\OperatorTok{*}\NormalTok{B}
  \ControlFlowTok{return}\NormalTok{ rowdict2mat(res)}
\end{Highlighting}
\end{Shaded}

\newpage{}

\hypertarget{dot-products-via-matrix-matrix-multiplication}{%
\section{Dot products via matrix-matrix
multiplication}\label{dot-products-via-matrix-matrix-multiplication}}

\hypertarget{problem-4.17.19}{%
\subsection{Problem 4.17.19}\label{problem-4.17.19}}

Let \(A\) be a matrix whose column labels are countries and whose row
labels are votes taken in the United Nations (UN), where \(A[i, j]\) is
\(+1\) or -1 or 0 depending on whether country \(j\) votes in favor of
or against neither in vote \(i\).\\
As in the politics lab, we can compare countries by comparing their
voting records. Let \(M = A^TA\). Then \(M\)'s row and column labels are
countries, and \(M[i, j]\) is the dot-product of country \(i\)'s voting
record with country \(j\)'s voting record. ~ The provided file
\texttt{UN\_voting\_data.txt} has one line per country. The line
consists of the country's name, followed by \(+1\)'s, -1's and zeroes,
separated by spaces. Read in the data and form the matrix \(A\). Then
form the matrix \(M = A^TA\). (Note: this will take quite a while---from
fifteen minutes to an hour, depending on your computer.)\\
Use \(M\) to answer the following questions.

\begin{Shaded}
\begin{Highlighting}[numbers=left,,]
  \ImportTok{from}\NormalTok{ matutil }\ImportTok{import} \OperatorTok{*}
  \ImportTok{from}\NormalTok{ vecutil }\ImportTok{import} \OperatorTok{*}

\BuiltInTok{file} \OperatorTok{=} \BuiltInTok{open}\NormalTok{(}\StringTok{\textquotesingle{}UN\_voting\_data.txt\textquotesingle{}}\NormalTok{, }\StringTok{\textquotesingle{}r\textquotesingle{}}\NormalTok{)}
\NormalTok{raw\_data }\OperatorTok{=} \BuiltInTok{file}\NormalTok{.readlines()}
\ControlFlowTok{for}\NormalTok{ i }\KeywordTok{in} \BuiltInTok{range}\NormalTok{(}\BuiltInTok{len}\NormalTok{(raw\_data)):}
\NormalTok{    line }\OperatorTok{=}\NormalTok{ raw\_data[i].replace(}\StringTok{\textquotesingle{}}\CharTok{\textbackslash{}n}\StringTok{\textquotesingle{}}\NormalTok{, }\StringTok{\textquotesingle{}\textquotesingle{}}\NormalTok{)}
\NormalTok{    raw\_data[i] }\OperatorTok{=}\NormalTok{ line}

\NormalTok{countries\_2d }\OperatorTok{=}\NormalTok{ []}
\ControlFlowTok{for}\NormalTok{ i }\KeywordTok{in} \BuiltInTok{range}\NormalTok{(}\BuiltInTok{len}\NormalTok{(raw\_data)):}
\NormalTok{    curr }\OperatorTok{=}\NormalTok{ raw\_data[i].split(}\StringTok{\textquotesingle{} \textquotesingle{}}\NormalTok{)}
\NormalTok{    country }\OperatorTok{=}\NormalTok{ curr[}\DecValTok{0}\NormalTok{]}
\NormalTok{    votes }\OperatorTok{=}\NormalTok{ []}
    \ControlFlowTok{for}\NormalTok{ j }\KeywordTok{in} \BuiltInTok{range}\NormalTok{(}\DecValTok{1}\NormalTok{, }\BuiltInTok{len}\NormalTok{(curr)):}
\NormalTok{        votes.append(}\BuiltInTok{int}\NormalTok{(curr[j]))}
\NormalTok{    countries\_2d.append([country, votes])}

\NormalTok{agreement\_map }\OperatorTok{=}\NormalTok{ \{\}}
\ControlFlowTok{for}\NormalTok{ i }\KeywordTok{in} \BuiltInTok{range}\NormalTok{(}\DecValTok{0}\NormalTok{, }\BuiltInTok{len}\NormalTok{(countries\_2d) }\OperatorTok{{-}} \DecValTok{1}\NormalTok{):}

\NormalTok{    country1 }\OperatorTok{=}\NormalTok{ countries\_2d[i][}\DecValTok{0}\NormalTok{]}
\NormalTok{    votes1 }\OperatorTok{=}\NormalTok{ countries\_2d[i][}\DecValTok{1}\NormalTok{]}

    \ControlFlowTok{for}\NormalTok{ j }\KeywordTok{in} \BuiltInTok{range}\NormalTok{(i }\OperatorTok{+} \DecValTok{1}\NormalTok{, }\BuiltInTok{len}\NormalTok{(countries\_2d)):}
\NormalTok{        country2 }\OperatorTok{=}\NormalTok{ countries\_2d[j][}\DecValTok{0}\NormalTok{]}
\NormalTok{        votes2 }\OperatorTok{=}\NormalTok{ countries\_2d[j][}\DecValTok{1}\NormalTok{]}

\NormalTok{        dot\_product }\OperatorTok{=} \DecValTok{0}
        \ControlFlowTok{for}\NormalTok{ k }\KeywordTok{in} \BuiltInTok{range}\NormalTok{(}\BuiltInTok{len}\NormalTok{(votes1)):}
\NormalTok{            dot\_product }\OperatorTok{+=}\NormalTok{ votes1[k] }\OperatorTok{*}\NormalTok{ votes2[k]}
\NormalTok{        agreement\_map[}\BuiltInTok{tuple}\NormalTok{([country1, country2])] }\OperatorTok{=}\NormalTok{ dot\_product}

\NormalTok{agreement\_map }\OperatorTok{=} \BuiltInTok{sorted}\NormalTok{(agreement\_map.items(), key}\OperatorTok{=}\KeywordTok{lambda}\NormalTok{ x:x[}\DecValTok{1}\NormalTok{])}
\end{Highlighting}
\end{Shaded}

\textbf{1. Which pair of countries are most opposed? (They have the most
negative dot-product.)}

\begin{Shaded}
\begin{Highlighting}[numbers=left,,]
\BuiltInTok{print}\NormalTok{(agreement\_map[}\DecValTok{0}\NormalTok{])}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
(('Belarus', 'United_States_of_America'), -1927)
\end{verbatim}

\textbf{2. What are the ten most opposed pairs of countries?}

\begin{Shaded}
\begin{Highlighting}[numbers=left,,]
\ControlFlowTok{for}\NormalTok{ i }\KeywordTok{in} \BuiltInTok{range}\NormalTok{(}\DecValTok{10}\NormalTok{):}
  \BuiltInTok{print}\NormalTok{(agreement\_map[i])}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
(('Belarus', 'United_States_of_America'), -1927)
(('United_States_of_America', 'Syria'), -1861)
(('United_States_of_America', 'Cuba'), -1807)
(('Algeria', 'United_States_of_America'), -1742)
(('United_States_of_America', 'Viet_Nam'), -1740)
(('Libya', 'United_States_of_America'), -1665)
(('United_States_of_America', 'Guinea'), -1616)
(('United_States_of_America', 'Mongolia'), -1615)
(('United_States_of_America', 'Mali'), -1605)
(('United_States_of_America', 'Sudan'), -1582)
\end{verbatim}

\textbf{3. Which pair of distinct countries are in the greatest
agreement (have the most positive dot-product)?}

\begin{Shaded}
\begin{Highlighting}[numbers=left,,]
\BuiltInTok{print}\NormalTok{(agreement\_map[}\OperatorTok{{-}}\DecValTok{1}\NormalTok{])}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
(('Philippines', 'Thailand'), 4229)
\end{verbatim}

\newpage{}

\hypertarget{comprehension-practice}{%
\section{Comprehension practice}\label{comprehension-practice}}

\hypertarget{problem-4.17.20}{%
\subsection{Problem 4.17.20}\label{problem-4.17.20}}

Write the one-line procedure \texttt{dictlist\_helper(dlist,\ k)} with
the following spec:\\

\begin{itemize}
\item \textit{input:} a list \verb|dlist| of dictionaries which all have the same keys, and a key \verb|k|
\item \textit{output:} the list whose $i^{th}$ element is the value corresponding to the key \verb|k| in the $i^{th}$ dictionary of \verb|dlist|
\item \textit{example:} With inputs \verb|dlist=[{'a': 'apple', 'b': 'bear'}, {'a': 1, 'b': 2}]| and \verb|k='a'|, the output is \verb|['apple', 1]|
\end{itemize}

The procedure should use a comprehension.

\begin{Shaded}
\begin{Highlighting}[numbers=left,,]
\KeywordTok{def}\NormalTok{ dictlist\_helper(dlist, k):}
  \ControlFlowTok{return}\NormalTok{ [d[k] }\ControlFlowTok{for}\NormalTok{ d }\KeywordTok{in}\NormalTok{ dlist]}
\NormalTok{dlist}\OperatorTok{=}\NormalTok{[\{}\StringTok{\textquotesingle{}a\textquotesingle{}}\NormalTok{:}\StringTok{\textquotesingle{}apple\textquotesingle{}}\NormalTok{, }\StringTok{\textquotesingle{}b\textquotesingle{}}\NormalTok{:}\StringTok{\textquotesingle{}bear\textquotesingle{}}\NormalTok{\}, \{}\StringTok{\textquotesingle{}a\textquotesingle{}}\NormalTok{:}\DecValTok{1}\NormalTok{, }\StringTok{\textquotesingle{}b\textquotesingle{}}\NormalTok{:}\DecValTok{2}\NormalTok{\}]}
\BuiltInTok{print}\NormalTok{(dictlist\_helper(dlist, }\StringTok{\textquotesingle{}a\textquotesingle{}}\NormalTok{))}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
['apple', 1]
\end{verbatim}

\newpage{}

\hypertarget{the-inverse-of-a-2-times-2-matrix}{%
\section{\texorpdfstring{The inverse of a \(2 \times 2\)
matrix}{The inverse of a 2 \textbackslash times 2 matrix}}\label{the-inverse-of-a-2-times-2-matrix}}

\hypertarget{problem-4.17.21}{%
\subsection{Problem 4.17.21}\label{problem-4.17.21}}

\textbf{1. Use a formula given in the text to solve the linear system}
\(\begin{bmatrix} 3 & 4 \\ 2 & 1 \end{bmatrix} \begin{bmatrix} x_1 \\ x_2 \end{bmatrix} = \begin{bmatrix} 1 \\ 0 \end{bmatrix}\).

\(3x_1 + 4x_2 = 1\\2x_1 + 1x_2 = 0\)

\(\implies\)

\(x_2 = -2x_1 \implies 3x_1 + 4(-2x_1) = 1 \implies x_1 = -\frac{1}{5}\),
and\\
\(x_2 = \frac{2}{5}\)

\(\begin{bmatrix}x_1\\x_2\end{bmatrix} = \begin{bmatrix}-\frac{1}{5}\\\frac{2}{5}\end{bmatrix}\)

\textbf{2. Use the formula to solve the linear system}
\(\begin{bmatrix} 3 & 4 \\ 2 & 1 \end{bmatrix} \begin{bmatrix} y_1 \\ y_2 \end{bmatrix} = \begin{bmatrix} 0 \\ 1 \end{bmatrix}\).

\(3y_1 + 4y_2 = 0\\2y_1 + 1y_2 = 1\)

\(\implies\)

\(y_2 = -\frac{3}{4}y_1 \implies 2y_1 - \frac{3}{4}y_1 = 1 \implies y_1 = \frac{4}{5}\),
and \(y_2 = -\frac{3}{5}\)

\(\begin{bmatrix}y_1\\y_2\end{bmatrix} = \begin{bmatrix}\frac{4}{5}\\-\frac{3}{5}\end{bmatrix}\)

\textbf{3. Use your solutions to find a} \(\bm{2 \times 2}\)
\textbf{matrix} \(\bm{M}\) \textbf{such that}
\(\begin{bmatrix} 3 & 4 \\ 2 & 1 \end{bmatrix}\) \textbf{times}
\(\bm{M}\) \textbf{is an identity matrix.}

\(M = \begin{bmatrix}x_1 &y_1\\x_2 &y_2\end{bmatrix} = \begin{bmatrix}-\frac{1}{5} &\frac{4}{5}\\\frac{2}{5} &-\frac{3}{5}\end{bmatrix}\)

\textbf{4. Calculate} \(\bm{M}\) \textbf{times}
\(\begin{bmatrix} 3 & 4 \\ 2 & 1 \end{bmatrix}\) \textbf{and calculate}
\(\begin{bmatrix} 3 & 4 \\ 2 & 1 \end{bmatrix}\) \textbf{times}
\(\bm{M}\) \textbf{and use \texttt{Corollary\ 4.13.19} to decide
whether} \(\bm{M}\) \textbf{is the inverse of}
\(\begin{bmatrix} 3 & 4 \\ 2 & 1 \end{bmatrix}\). \textbf{Explain your
answer.}

\(\begin{bmatrix}-\frac{1}{5} &\frac{4}{5}\\\frac{2}{5} &-\frac{3}{5}\end{bmatrix} \begin{bmatrix}3 &4\\2 &1\end{bmatrix} = \begin{bmatrix}1 &0\\0 &1\end{bmatrix}\)

\(\begin{bmatrix}3 &4\\2 &1\end{bmatrix} \begin{bmatrix}-\frac{1}{5} &\frac{4}{5}\\\frac{2}{5} &-\frac{3}{5}\end{bmatrix} = \begin{bmatrix}1 &0\\0 &1\end{bmatrix}\)

Since \(AB\) and \(BA\) are both identity matrices, \(M\) is the inverse
of \(\begin{bmatrix} 3 & 4 \\ 2 & 1 \end{bmatrix}\) according to
\texttt{Corollary\ 4.13.19}.

\newpage{}

\hypertarget{matrix-inverse-criterion}{%
\section{Matrix inverse criterion}\label{matrix-inverse-criterion}}

\hypertarget{problem-4.17.22}{%
\subsection{Problem 4.17.22}\label{problem-4.17.22}}

For each of the parts below, use \texttt{Corollary\ 4.13.19} to
demonstrate that the pairs of matrices given are or are not inverse of
each other.\\
\textbf{1. matrices} \(\begin{bmatrix} 5 & 1 \\ 9 & 2 \end{bmatrix}\),
\(\begin{bmatrix} 2 & -1 \\ -9 & 5 \end{bmatrix}\) \textbf{over}
\(\bm{\mathbb{R}}\)

\(\begin{bmatrix}5 &1\\9 &2\end{bmatrix} \begin{bmatrix}2 &-1\\-9 &5\end{bmatrix} = \begin{bmatrix}1 &0\\0 &1\end{bmatrix}\)

\(\begin{bmatrix}2 &-1\\-9 &5\end{bmatrix} \begin{bmatrix}5 &1\\9 &2\end{bmatrix} = \begin{bmatrix}1 &0\\0 &1\end{bmatrix}\)

These matrices are inverses.

\textbf{2. matrices} \(\begin{bmatrix} 2 & 0 \\ 0 & 1 \end{bmatrix}\),
\(\begin{bmatrix} \frac{1}{2} & 0 \\ 0 & 1 \end{bmatrix}\) \textbf{over}
\(\bm{\mathbb{R}}\)

\(\begin{bmatrix}2 &0\\0 &1\end{bmatrix} \begin{bmatrix}\frac{1}{2} &0\\0 &1\end{bmatrix} = \begin{bmatrix}1 &0\\0 &1\end{bmatrix}\)

\(\begin{bmatrix}\frac{1}{2} &0\\0 &1\end{bmatrix} \begin{bmatrix}2 &0\\0 &1\end{bmatrix} = \begin{bmatrix}1 &0\\0 &1\end{bmatrix}\)

These matrices are inverses.

\textbf{3. matrices} \(\begin{bmatrix} 3 & 1 \\ 0 & 2 \end{bmatrix}\),
\(\begin{bmatrix} 1 & \frac{1}{6} \\ -2 & \frac{1}{2} \end{bmatrix}\)
\textbf{over} \(\bm{GF(2)}\)

\(\begin{bmatrix}3 &1\\0 &2\end{bmatrix} \begin{bmatrix}1 &\frac{1}{6}\\-2 &\frac{1}{2}\end{bmatrix} = \begin{bmatrix}1 &1\\-4 &1\end{bmatrix}\)

\(\begin{bmatrix}1 &\frac{1}{6}\\-2 &\frac{1}{2}\end{bmatrix} \begin{bmatrix}3 &1\\0 &2\end{bmatrix} = \begin{bmatrix}3 &\frac{4}{3}\\-6 &-1\end{bmatrix}\)

These matrices are \emph{not} inverses.

\textbf{4. matrices}
\(\begin{bmatrix} 1 & 0 & 1 \\ 0 & 1 & 0 \end{bmatrix}\) \textbf{over}
\(\bm{GF(2)}\)

\(\begin{bmatrix}1 &0 &1\\0 &1 &0\end{bmatrix} \begin{bmatrix}0 &1\\0 &1\\1 &1\end{bmatrix} = \begin{bmatrix}1 &0\\0 &1\end{bmatrix}\)

\(\begin{bmatrix}0 &1\\0 &1\\1 &1\end{bmatrix} \begin{bmatrix}1 &0 &1\\0 &1 &0\end{bmatrix} = \begin{bmatrix}0 &1 &0\\0 &1 &0\\1 &1 &1\end{bmatrix}\)

These matrices are \emph{not} inverses.

\hypertarget{problem-4.17.23}{%
\subsection{Problem 4.17.23}\label{problem-4.17.23}}

Specify a function \(f\) (by domain, co-domain, and rule) that is
invertible but such that there is no matrix \(A\) such that
\(f(\bm{x}) = A\bm{x}\).

If \(f(\bm{x}) = \{x_i^3, x_i \in \bm{x}\}\), then\\
\(f'(\bm{x}) = g(\bm{x}) = \{x_i^\frac{1}{3}, x_i \in \bm{x}\}\), but
there is no matrix \(A\) where \(f(\bm{x}) = A\bm{x}\).



\end{document}
